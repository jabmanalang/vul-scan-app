from src.vulnerability.models import Vulnerability
from src.vulnerability.schemas import VulnerabilityOut


def map_to_schema(vul: Vulnerability) -> VulnerabilityOut:
    assets_out = []
    for asset in vul.affected_assets:
        assets_out.append(asset.id)
    vul_out = VulnerabilityOut(
        id=vul.id,
        from_scan=vul.from_scan.id,
        severity=vul.severity,
        name=vul.name,
        description=vul.description,
        solution=vul.solution,
        references=vul.references,
        cvss_base_score=vul.cvss_base_score,
        affected_assets=assets_out
    )
    return vul_out
