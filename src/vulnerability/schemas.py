from fastapi import Query
from pydantic import BaseModel

from src.enums import Severity


class VulnerabilityBase(BaseModel):
    from_scan: int
    severity: Severity
    name: str
    description: str
    solution: str
    references: str
    cvss_base_score: str
    affected_assets: list[int]


class VulnerabilityIn(VulnerabilityBase):
    pass


class VulnerabilityOut(VulnerabilityBase):
    id: int


class VulnerabilityListOut(BaseModel):
    vulnerabilities: list[VulnerabilityOut]
